import{d as A,f as _,a as m,s as C,e as N,r as B}from"../chunks/thVPWqqE.js";import{T as F,$ as H,N as K,V as I,X as V,Y as s,_ as u,Z as r,W as X}from"../chunks/DWeqF1KP.js";import{i as Y,s as Z,a as D}from"../chunks/Dr2B9Zze.js";import{s as o,a as J,b as f,c as L}from"../chunks/DtU6cGUf.js";const Q=!0,le=Object.freeze(Object.defineProperty({__proto__:null,prerender:Q},Symbol.toStringTag,{value:"Module"}));async function R(t){if(!t)return{error:"Missing required user data"};const{data:i,error:c}=await o.from("users").upsert({name:t.user_metadata.full_name,email:t.email,image:t.user_metadata.avatar_url},{onConflict:"email"});return c?{error:c.message}:{success:!0,user:i}}var ee=()=>o.auth.signOut(),ae=_('<h1 class="px-3 has-text-weight-semibold is-hidden-mobile"> </h1>  <figure class="image is-48x48 clickable-figure dropdown is-hoverable is-right"><div class="dropdown-trigger"><img class="is-rounded" alt="Profile"/></div> <div class="dropdown-menu" id="dropdown-menu4" role="menu"><div class="dropdown-content"><div class="dropdown-item is-flex is-justify-content-center is-align-items-center"><a class="has-text-danger is-size-6 clickable-figure"><strong>Sign Out</strong></a></div></div></div></figure>',1),se=(t,i)=>i(),re=_('<button class="button is-bold">Sign in with Google</button>'),te=_('<main><nav class="navbar is-opaque px-3 py-2"><div class="navbar-container is-flex is-justify-content-space-between is-align-items-center" style="width: 100%;"><div class="navbar-brand"><h1 class="navbar-item has-text-weight-semibold is-size-5">BOOKISH SPOON</h1></div> <div class="navbar-end is-flex is-align-items-center"><!></div></div></nav></main> <!>',1);function ue(t,i){F(i,!0);const[c,j]=Z(),l=()=>D(f,"$session",c);async function $(){const{error:e}=await o.auth.signInWithOAuth({provider:"google",options:{redirectTo:window.location.origin}});e&&console.log("Google Sign-in Error:",e.message)}H(async()=>{const{data:e}=await o.auth.getSession();f.set(e.session),o.auth.onAuthStateChange((a,n)=>{f.set(n)})});const z="/images/fallbackImage.jpg";function E(e){const a=e.target;a.src=z}K(()=>{const e=l();if(!e||!e.user)return;const a=e.user;G(a)});async function G(e){try{const a=await R(e);if(!a.success||a.error)throw new Error(a.error||"Failed to sync user")}catch(a){console.error(a.message||"Unknown error")}}var p=te(),d=I(p),h=s(d),b=s(h),w=u(s(b),2),M=s(w);{var P=e=>{var a=ae(),n=I(a),W=s(n,!0);r(n);var y=u(n,2),v=s(y),g=s(v);r(v);var x=u(v,2),k=s(x),q=s(k);q.__click=[ee],r(k),r(x),r(y),X(()=>{var O,S;C(W,(O=l().user)==null?void 0:O.user_metadata.full_name),L(g,"src",(S=l().user)==null?void 0:S.user_metadata.avatar_url)}),N("error",g,E),B(g),m(e,a)},T=e=>{var a=re();a.__click=[se,$],m(e,a)};Y(M,e=>{l()?e(P):e(T,!1)})}r(w),r(b),r(h),r(d);var U=u(d,2);J(U,()=>i.children),m(t,p),V(),j()}A(["click"]);export{ue as component,le as universal};
