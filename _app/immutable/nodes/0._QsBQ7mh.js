import{d as A,f as v,h as C,a as d,s as K,e as N,r as B}from"../chunks/t7vGSiwy.js";import{K as F,M as H,N as Q,O as I,Q as R,R as s,T as u,V as r,W as V}from"../chunks/giZKJhDQ.js";import{i as D,s as J,a as L}from"../chunks/BOKzMFe0.js";import{s as o,a as X,b as _,c as Y}from"../chunks/Du8Kyzin.js";const Z=!0,ue=Object.freeze(Object.defineProperty({__proto__:null,prerender:Z},Symbol.toStringTag,{value:"Module"}));async function ee(t){if(!t)return{error:"Missing required user data"};const{data:i,error:l}=await o.from("users").upsert({name:t.user_metadata.full_name,email:t.email,image:t.user_metadata.avatar_url},{onConflict:"email"});return l?{error:l.message}:{success:!0,user:i}}var ae=v('<link rel="stylesheet" href="/global.css"/>'),se=()=>o.auth.signOut(),re=v('<h1 class="px-3 has-text-weight-semibold is-hidden-mobile"> </h1>  <figure class="image is-48x48 clickable-figure dropdown is-hoverable is-right"><div class="dropdown-trigger"><img class="is-rounded" alt="Profile"/></div> <div class="dropdown-menu" id="dropdown-menu4" role="menu"><div class="dropdown-content"><div class="dropdown-item is-flex is-justify-content-center is-align-items-center"><a class="has-text-danger is-size-6 clickable-figure"><strong>Sign Out</strong></a></div></div></div></figure>',1),te=(t,i)=>i(),ie=v('<button class="button is-bold">Sign in with Google</button>'),ne=v('<main><nav class="navbar is-opaque px-3 py-2"><div class="navbar-container is-flex is-justify-content-space-between is-align-items-center" style="width: 100%;"><div class="navbar-brand"><h1 class="navbar-item has-text-weight-semibold is-size-5">BOOKISH SPOON</h1></div> <div class="navbar-end is-flex is-align-items-center"><!></div></div></nav></main> <!>',1);function ve(t,i){F(i,!0);const[l,j]=J(),c=()=>L(_,"$session",l);async function M(){const{error:e}=await o.auth.signInWithOAuth({provider:"google",options:{redirectTo:window.location.origin}});e&&console.log("Google Sign-in Error:",e.message)}H(async()=>{const{data:e}=await o.auth.getSession();_.set(e.session),o.auth.onAuthStateChange((a,n)=>{_.set(n)})});const z="/images/fallbackImage.jpg";function E(e){const a=e.target;a.src=z}Q(()=>{const e=c();if(!e||!e.user)return;const a=e.user;G(a)});async function G(e){try{const a=await ee(e);if(!a.success||a.error)throw new Error(a.error||"Failed to sync user")}catch(a){console.error(a.message||"Unknown error")}}var h=ne();C(e=>{var a=ae();d(e,a)});var g=I(h),p=s(g),b=s(p),w=u(s(b),2),P=s(w);{var T=e=>{var a=re(),n=I(a),$=s(n,!0);r(n);var y=u(n,2),m=s(y),f=s(m);r(m);var k=u(m,2),x=s(k),q=s(x);q.__click=[se],r(x),r(k),r(y),V(()=>{var O,S;K($,(O=c().user)==null?void 0:O.user_metadata.full_name),Y(f,"src",(S=c().user)==null?void 0:S.user_metadata.avatar_url)}),N("error",f,E),B(f),d(e,a)},U=e=>{var a=ie();a.__click=[te,M],d(e,a)};D(P,e=>{c()?e(T):e(U,!1)})}r(w),r(b),r(p),r(g);var W=u(g,2);X(W,()=>i.children),d(t,h),R(),j()}A(["click"]);export{ve as component,ue as universal};
